version: 1
description: Directed node dependency graph (A -> B means B consumes fields produced by A)
aggregate_nodes: [TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]

edges:
  # 采集层 -> 中间层/报告
  PATIENT_INFO: [STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM]
  LAB_RESULTS: [DIFFUSE_EVAL, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  DEVICE_IMPORT: [STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM]
  VIDEO_INPUT: [VIDEO_SEG, KEYFRAME, BLOOD_OVERALL]

  # 影像中间层
  VIDEO_SEG: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM]   # 视觉/结构化报告会引图像摘要
  KEYFRAME: [IMG_SEG, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM]
  IMG_SEG: [ORG_OVERVIEW, NODULE_EVAL, NODULE_FINE, INVASION, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM]

  # 分析层
  ORG_OVERVIEW: [NODULE_EVAL, TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  NODULE_EVAL: [BLOOD_NODULE, NODULE_FINE, FUNC_IMAGING, TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  BLOOD_OVERALL: [DIFFUSE_EVAL, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  BLOOD_NODULE: [TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  NODULE_FINE: [TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  INVASION: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  FUNC_IMAGING: [TI-RADS, VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  DIFFUSE_EVAL: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  PARATHYROID_EVAL: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  LYMPH_EVAL: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]

  # 汇总与报告层（链式）
  TI-RADS: [VIS_REPORT, STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  VIS_REPORT: [STRUCT_REPORT, ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  STRUCT_REPORT: [ARCHIVE_REPORT, PATIENT_COMM, FOLLOW_UP]
  ARCHIVE_REPORT: [PATIENT_COMM, FOLLOW_UP]
  PATIENT_COMM: [FOLLOW_UP]
  FOLLOW_UP: []
